{% extends "myApp/base.html" %}
{% block content %}
<div class="container mt-5">
  <h2 class="text-white">Your Tasks</h2>

  <!-- Add Task Form -->
  <form method="POST" action="{% url 'add_task' %}" class="form-inline my-3">
    {% csrf_token %}
    <input type="text" name="title" placeholder="Task Title" required class="form-control mr-2">
    <input type="text" name="description" placeholder="Task Description" required class="form-control mr-2">
    <input type="date" name="date" required class="form-control mr-2">
    <button type="submit" class="btn btn-primary">Add Task</button>
  </form>

  <!-- Task List Table -->
  <table class="table table-dark table-hover">
    <thead>
      <tr>
        <th>Title</th>
        <th>Description</th>  <!-- ✅ Added Description column -->
        <th>Date</th>
        <th>Action</th>
        <th>Time Left</th>
      </tr>
    </thead>
    <tbody>
      {% if tasks %}
        {% for task in tasks %}
          <tr>
            <td>{{ task.title }}</td>
            <td>{{ task.description }}</td>  <!-- ✅ Display task description -->
            <td>{{ task.date }}</td>
            <td>
             <a href="{% url 'edit_task' task.id %}" class="btn btn-warning btn-sm">Edit</a>
             <a href="{% url 'delete_task' task.id %}" class="btn btn-danger btn-sm">Delete</a>
             </td>
            <td>
              {% if task.time_left != None %}
                {% if task.time_left > 0 %}
                  {{ task.time_left }} day{{ task.time_left|pluralize }} left
                {% elif task.time_left == 0 %}
                  Due today!
                {% else %}
                  Time's up
                {% endif %}
              {% else %}
                No due date
              {% endif %}
            </td>
          </tr>
        {% empty %}
          <tr><td colspan="5">No tasks found.</td></tr>  <!-- ✅ Updated colspan -->
        {% endfor %}
      {% endif %}
    </tbody>
  </table>
</div>
{% endblock %}
